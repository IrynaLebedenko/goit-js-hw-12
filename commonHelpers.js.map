{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\n\n const fetchImageForm = document.querySelector('.form');\n const gallery = document.querySelector('.gallery');\n const userInput = document.querySelector('input');\n const container = document.querySelector('.container');\n const btnLoadMore = document.querySelector('.btn-load');\n const loadingText = document.querySelector('.loading-text');\n\nlet page = 1;\nlet per_page = 15;\nlet totalHits = 0;\n// Function showing the loading text\nconst showLoadingText = () => {\n    loadingText.style.display = 'block';\n  };\n  \n  // Function hiding the loading text\n  const hideLoadingText = () => {\n      loadingText.style.display = 'none';\n  };\n\n  // Function to show loadMore button\nconst showLoadMoreButton = () => {\n    btnLoadMore.style.display = 'block';\n};\n\n// Function to hide loadMore button\nconst hideLoadMoreButton = () => {\n    btnLoadMore.style.display = 'none';\n};\n\nconst options = {\n    captions: true,\n    captionSelector: 'img',\n    captionType: 'attr',\n    captionsData: 'alt',\n    captionPosition: 'bottom',\n    animation: 250,\n  };\n\nconst lightbox = new SimpleLightbox('.gallery a', options);\nlet query;\nfetchImageForm.addEventListener('submit', async (event) => {\n    per_page = 15;\n  event.preventDefault(); \n  showLoadingText();\n  hideLoadMoreButton();\n  gallery.innerHTML = ''; \n  const pixabayApiKey = '42400311-c577e995298d386a6e7116ddb';\n  query = userInput.value.trim();\n  if(!query){\n    iziToast.error({\n        backgroundColor: '#EF4040',\n        message:\n          'Please. enter a search query!',\n        position: 'topRight',\n      });\n      hideLoadingText();\n      hideLoadMoreButton();\n    return;\n  }\n try {\n    const response = await axios.get(\n        `https://pixabay.com/api/?key=${pixabayApiKey}&q=${encodeURIComponent(query)}&image_type=photo&orientation=horizontal&safesearch=true&page=1&per_page=${per_page}`\n    );\n\n      const data = response.data;\n   \n      if (!data.hits.length) {\n        \n        iziToast.error({\n          title: '',\n          backgroundColor: '#EF4040',\n          message:\n            'Sorry, there are no images matching your search query. Please try again!',\n          position: 'topRight',\n      });\n      hideLoadMoreButton();\n      \n    } else {\n        showLoadingText();\n        const markup = data.hits\n        .map(data => {\n            return ` <li class=\"gallery-item\">\n      <a href=\"${data.webformatURL}\">\n        <img class=\"gallery-image\" src=\"${data.webformatURL}\" alt=\"${data.tags}\">\n      </a>\n      <div class=\"image-details\">\n        <div class=\"image-text\">\n        <p><b class=\"image-text-width\">Likes: </b>${data.likes}</p>\n        <p><b class=\"image-text-width\">Views: </b>${data.views}</p>\n        <p><b class=\"image-text-width\">Comments: </b>${data.comments}</p>\n        <p><b class=\"image-text-width\">Downloads: </b>${data.downloads}</p>\n        \n        </div>\n      </div>\n    </li>`;\n          })\n          .join('');\n      gallery.insertAdjacentHTML('afterbegin', markup);\n      lightbox.refresh();\n      showLoadMoreButton();\n      }\n    \n    } catch(error) {\n      console.log(error);\n    } finally {\n      hideLoadingText();\n    }\n});\n\nbtnLoadMore.addEventListener('click', async (event) => {\n      page++;\n      showLoadingText();\n      hideLoadMoreButton();\n      event.preventDefault(); \n      \n      const pixabayApiKey = '42400311-c577e995298d386a6e7116ddb';\n      query = userInput.value.trim();\n \n     try {\n        const response = await axios.get(\n            \n            `https://pixabay.com/api/?key=${pixabayApiKey}&q=${encodeURIComponent(query)}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=${per_page}`\n        );\n            const data = response.data;\n      \n            if (data.hits.length) {\n            const markup = data.hits\n            .map(data => {\n                return ` <li class=\"gallery-item\">\n          <a href=\"${data.webformatURL}\">\n            <img class=\"gallery-image\" src=\"${data.webformatURL}\" alt=\"${data.tags}\">\n          </a>\n          <div class=\"image-details\">\n            <div class=\"image-text\">\n            <p><b class=\"image-text-width\">Likes: </b>${data.likes}</p>\n            <p><b class=\"image-text-width\">Views: </b>${data.views}</p>\n            <p><b class=\"image-text-width\">Comments: </b>${data.comments}</p>\n            <p><b class=\"image-text-width\">Downloads: </b>${data.downloads}</p>\n            \n          </div>\n        </li>`;\n              })\n              .join('');\n              gallery.insertAdjacentHTML('beforeend', markup);\n          lightbox.refresh();\n\n// We get the height of one gallery card\nconst cardHeight = document.querySelector('.gallery-image').getBoundingClientRect().height;\n\n// Scroll the page to the distance of two card heights\nconst scrollToNextGroup = () => {\n    window.scrollBy({\n        top: 2 * cardHeight,\n        behavior: 'smooth' \n    });\n};\n\n// Call the scrolling function\nscrollToNextGroup();\n\n          showLoadingText();\n          totalHits = data.totalHits;\n          if (totalHits <= per_page * page) {\n            // Show a message about the end of search results\n            const endMessage = document.createElement('div');\n            endMessage.innerText = \"We're sorry, but you've reached the end of search results.\";\n            gallery.appendChild(endMessage); \n            }\n        };\n        } catch(error) {\n          console.log(error);\n        } finally {\n          hideLoadingText();\n          if ( totalHits > per_page * page ){\n            showLoadMoreButton();\n            \n          }\n        }\n    });\n"],"names":["fetchImageForm","gallery","userInput","btnLoadMore","loadingText","page","per_page","totalHits","showLoadingText","hideLoadingText","showLoadMoreButton","hideLoadMoreButton","options","lightbox","SimpleLightbox","query","event","pixabayApiKey","iziToast","data","axios","markup","error","cardHeight","endMessage"],"mappings":"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"}